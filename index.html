<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Doce V√≠cio ‚Äî Doceria Artesanal</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="asserts/Doce.png">
  <style>
    :root{
      --brown: #5a3a29;
      --gold: #d4af37;
      --white: #ffffff;
      --beige: #f8f5f2;
      --muted: #7a6a66;
      --radius: 12px;
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--beige);
      color:var(--brown);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.35;
      font-size:16px;
    }
    header{text-align:center;padding:20px 16px 8px;background:transparent;position:sticky;top:0;z-index:40;}
    .logo-wrap{display:flex;flex-direction:column;align-items:center;gap:8px;}
    .logo{width:82px;height:82px;border-radius:50%;background:linear-gradient(135deg,var(--brown),#7b4b45);display:flex;align-items:center;justify-content:center;color:var(--white);font-weight:700;font-size:22px;box-shadow:0 6px 18px rgba(90,58,41,0.12);}
    .logo-img {width:82px;height:82px;border-radius:50%;object-fit:cover;margin-bottom:8px;}
    h1.site-title{margin:0;font-size:20px;font-weight:700;letter-spacing:0.2px}
    p.slogan{margin:6px 0 0;color:var(--muted);font-size:14px;font-weight:500}
    
    .container{
      display:flex;
      flex-direction:column;
      gap:20px;
      padding:18px;
      max-width:1100px;
      margin:0 auto 40px;
    }

    .menu{flex:1 1 640px;display:flex;flex-direction:column;gap:12px;align-items:flex-start;}
    .section-title{font-weight:700;margin:0 0 6px;font-size:18px}
    .product-list{display:grid;grid-template-columns:1fr;gap:12px;width:100%}
    .product{display:flex;gap:12px;align-items:flex-start;background:var(--white);padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.04);width:100%;}
    .product img{width:96px;height:96px;object-fit:cover;border-radius:10px;flex-shrink:0}
    .product-info{flex:1}
    .product-info h3{margin:0;font-size:16px}
    .product-info p{margin:6px 0;color:var(--muted);font-size:13px}
    .product-meta{display:flex;align-items:center;gap:8px;margin-top:6px}
    .price{font-weight:800;font-size:15px;color:var(--brown)}
    .weight{font-size:13px;color:var(--muted)}
    .controls{display:flex;flex-direction:column;align-items:flex-end;gap:8px}
    .add-btn{background:var(--gold);border:none;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer}

    aside.sidebar{
      width:100%;
      max-width:100%;
      position:relative;
      top:auto;
      height:auto;
      overflow:visible;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .card{background:var(--white);padding:14px;border-radius:12px;border:1px solid rgba(0,0,0,0.04)}
    .cart-bar{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .cart-count{background:var(--brown);color:var(--white);padding:6px 10px;border-radius:999px;font-weight:700;font-size:14px}
    .cart-items{display:flex;flex-direction:column;gap:10px;margin-top:8px;max-height:250px;overflow:auto}
    .cart-item{display:flex;gap:10px;align-items:center}
    .cart-item img{width:56px;height:56px;object-fit:cover;border-radius:8px}
    .qty{display:flex;gap:6px;align-items:center}
    .qty button{padding:6px;border-radius:6px;border:1px solid #e6ded9;background:#fff;cursor:pointer}
    .total{margin-top:10px;font-weight:800;font-size:18px;color:var(--brown)}
    .checkout{margin-top:12px;background:var(--brown);color:var(--white);border:none;padding:10px;border-radius:10px;font-weight:800;cursor:pointer;width:100%}
    .ifood-note{display:flex;gap:8px;align-items:flex-start;padding:10px;border-radius:8px;background:linear-gradient(90deg, rgba(212,175,55,0.08), rgba(90,58,41,0.02));border:1px dashed rgba(212,175,55,0.12);font-size:13px;color:var(--muted)}
    form.customer{display:flex;flex-direction:column;gap:8px;margin-top:6px}
    input, textarea, select{padding:10px;border-radius:8px;border:1px solid #eee;background:#fff;font-size:14px}
    .two-cols{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .reviews-list{display:flex;flex-direction:column;gap:10px;margin-top:8px;max-height:220px;overflow:auto}
    .review{background:#fff;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.03)}
    .stars{color:var(--gold);font-weight:700}
    footer{margin-top:24px;text-align:center;color:var(--muted);font-size:13px;padding:24px 0}
    .social-footer{margin-top:24px;text-align:center;padding:12px 0;background:var(--brown);color:var(--white);border-radius:12px;font-size:14px;display:flex;justify-content:center;gap:16px;flex-wrap:wrap;}
    .social-footer a{color:var(--white);text-decoration:none;font-weight:600}
    #reviewsSummary{margin:16px auto;max-width:600px;text-align:center;cursor:pointer;}
  </style>
</head>
<body>

  <!-- Header (centralizado) -->
  <header>
     <img src="asserts/Sobremesa de Brownie com Sorvete.png" alt="Banner Doce V√≠cio" style="width:100%;max-height:250px;object-fit:cover;border-radius:12px;margin-bottom:12px;" />
    <div class="logo-wrap" role="banner">
      <img src="asserts/Doce.png" alt="Doce V√≠cio" class="logo-img" />
      <h1 class="site-title">Doce V√≠cio ‚Äî Doceria Artesanal</h1>
      <p class="slogan">Doces feitos √† m√£o, com amor em cada detalhe.</p>
    </div>

    <div id="reviewsSummary" class="card">
      <strong id="reviewsAverage">‚≠ê 0 ‚Äî 0 avalia√ß√µes</strong>
      <p style="margin:6px 0 0;color:var(--muted);font-size:13px">Clique para ver os coment√°rios</p>
    </div>

    <div class="card" style="margin:16px auto 0; max-width:600px;">
      <strong>Sobre a Doce V√≠cio</strong>
      <p style="margin:8px 0 0;color:var(--muted);font-size:14px">
        Bem-vindos √† Doce V√≠cio! Na nossa Doceria Artesanal, cada doce √© feito √† m√£o com amor, cuidado e um toque de delicadeza.
        Acreditamos que o verdadeiro sabor est√° nos detalhes ‚Äî no aroma que sai do forno, na textura perfeita e na sensa√ß√£o de conforto a cada mordida.
        Aqui, o simples vira especial: bolos, mousses, empad√µes... ganham um toque artesanal e elegante, pensados para ado√ßar seus dias com charme e aconchego.
        Porque na Doce V√≠cio, cada pedacinho √© um carinho ‚Äî e cada sabor, um abra√ßo doce.
      </p>
    </div>
  </header>

  <!-- Main area -->
  <div class="container" role="main">

    <main class="menu" aria-label="Card√°pio">
      <h2 class="section-title">Card√°pio</h2>
      <div class="product-list" id="productList"></div>
    </main>

    <!-- Sidebar agora abaixo do card√°pio -->
    <aside class="sidebar" aria-label="Resumo do pedido e formul√°rio">

      <!-- Carrinho / Total -->
      <div class="card">
        <div class="cart-bar">
          <div>
            <strong>Seu pedido</strong>
            <div style="font-size:13px;color:var(--muted)">Itens adicionados aparecem aqui</div>
          </div>
          <div class="cart-count" id="cartCount">0</div>
        </div>

        <div class="cart-items" id="cartItems" aria-live="polite" style="margin-top:10px;"></div>

        <div class="total" id="cartTotal">Total: R$ 0,00</div>

        <div style="margin-top:10px" class="ifood-note">
          <div style="font-size:18px">üì¶</div>
          <div style="font-size:13px">
            <strong>Entregas sob demanda via iFood</strong>
            <div style="color:var(--muted);margin-top:6px">O valor da taxa de entrega ser√° informado ap√≥s a confirma√ß√£o do pedido.</div>
          </div>
        </div>

        <button class="checkout" id="checkoutBtn">Finalizar pedido (WhatsApp)</button>
      </div>

      <!-- Formul√°rio do cliente -->
      <div class="card">
        <strong>Dados do cliente</strong>
        <form class="customer" id="customerForm" onsubmit="return false;">
          <div class="two-cols">
            <input type="text" id="firstName" placeholder="Nome" required />
            <input type="text" id="lastName" placeholder="Sobrenome" required />
          </div>
          <input type="text" id="address" placeholder="Endere√ßo (Rua, n√∫mero, complemento)" required />
          <input type="text" id="contact" placeholder="Contato (ex: +55 83 9xxxx-xxxx)" required />
          <textarea id="notes" placeholder="Anota√ß√µes (trocar cobertura, observa√ß√µes)" rows="3"></textarea>
        </form>
      </div>

      <!-- Avalia√ß√µes -->
      <div class="card" id="reviewsCard">
        <strong>‚≠ê Deixe seu sabor na nossa hist√≥ria!</strong>
        <p style="margin:6px 0 10px;color:var(--muted);font-size:13px">Avalie a nossa doceria!</p>

        <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
          <div id="starInputs" style="display:flex;gap:6px"></div>
        </div>

        <textarea id="reviewText" placeholder="Deixe um coment√°rio breve..." rows="2"></textarea>
        <button id="submitReview" style="margin-top:8px;background:var(--gold);border:none;padding:8px;border-radius:8px;font-weight:700;cursor:pointer">Enviar avalia√ß√£o</button>

        <div class="reviews-list" id="reviewsList" style="margin-top:12px"></div>
      </div>

      <footer style="margin-top:8px">
        <small style="color:var(--muted)">Doce V√≠cio ‚Äî Doceria Artesanal</small>
      </footer>

      <!-- Rodap√© social adicionado -->
      <div class="social-footer">
        <a href="https://www.instagram.com/seuusuario" target="_blank">Instagram</a>
        <a href="https://www.facebook.com/seuusuario" target="_blank">Facebook</a>
      </div>
    </aside>

  </div>

  <!-- Firebase + Script de produtos e avalia√ß√µes -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js";

  const firebaseConfig = {
  apiKey: "AIzaSyD5TQRn_pldHdZNio9yrKVQj7QnZGhChOI",
  authDomain: "doce-vicio-e198c.firebaseapp.com",
  projectId: "doce-vicio-e198c",
  storageBucket: "doce-vicio-e198c.appspot.com",
  messagingSenderId: "1041720667857",
  appId: "1:1041720667857:web:8c8c1d2933d3f26813dff0"
};


    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const reviewsCol = collection(db, "reviews");

    // elementos da UI
    const reviewsListEl = document.getElementById("reviewsList");
    const reviewsAverageEl = document.getElementById("reviewsAverage");
    const starInputsEl = document.getElementById("starInputs");

    // criar inputs de estrela
    for (let i = 5; i >= 1; i--) {
      const label = document.createElement("label");
      label.style.cursor = "pointer";
      label.dataset.value = i;
      label.innerHTML = "‚òÖ";

      const input = document.createElement("input");
      input.type = "radio";
      input.name = "star";
      input.value = i;
      input.style.display = "none";
      label.appendChild(input);

     label.addEventListener("click", () => {
  const val = Number(label.dataset.value); // valor da estrela clicada
  document.querySelectorAll('input[name="star"]').forEach(inp => inp.checked = false);
  input.checked = true;
  document.querySelectorAll("#starInputs label").forEach(l => {
    // agora colorimos as estrelas >= do valor clicado
    l.style.color = (Number(l.dataset.value) >= val) ? "var(--gold)" : "#ccc";
  });
});


      starInputsEl.appendChild(label);
    }
    document.querySelectorAll("#starInputs label").forEach(l => l.style.color = "#ccc");

    // carregar avalia√ß√µes do Firestore
    async function loadReviewsFromFirebase() {
      try {
        const q = query(reviewsCol, orderBy("timestamp", "desc"));
        const snapshot = await getDocs(q);
        const reviews = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
        reviewsListEl.innerHTML = "";
        reviews.forEach(r => {
          const el = document.createElement("div");
          el.className = "review";
          const stars = Number(r.stars) || 0;
          el.innerHTML = `<div class="stars">${'‚òÖ'.repeat(stars)+'‚òÜ'.repeat(5-stars)}</div><div>${r.text || ''}</div>`;
          reviewsListEl.appendChild(el);
        });
        if (reviews.length > 0) {
          const avg = (reviews.reduce((a,b)=>a+(Number(b.stars)||0),0)/reviews.length).toFixed(1);
          reviewsAverageEl.textContent = `‚≠ê ${avg} ‚Äî ${reviews.length} avalia√ß√£o${reviews.length>1?'s':''}`;
        } else {
          reviewsAverageEl.textContent = "‚≠ê 0 ‚Äî 0 avalia√ß√µes";
        }
      } catch (e) {
        console.error("Erro carregando avalia√ß√µes:", e);
      }
    }

    // envio de avalia√ß√£o
    document.getElementById("submitReview").addEventListener("click", async ()=>{
      try {
        const stars = Number(document.querySelector('input[name="star"]:checked')?.value||0);
        const text = document.getElementById("reviewText").value.trim();
        if(stars===0 || !text){ alert("Selecione estrelas e escreva seu coment√°rio."); return; }
        await addDoc(reviewsCol, { stars, text, timestamp: serverTimestamp() });
        document.getElementById("reviewText").value = "";
        document.querySelectorAll('input[name="star"]').forEach(i => i.checked = false);
        document.querySelectorAll("#starInputs label").forEach(l => l.style.color = "#ccc");
        loadReviewsFromFirebase();
      } catch (err) {
        console.error("Erro ao enviar avalia√ß√£o:", err);
        alert("Ocorreu um erro ao enviar sua avalia√ß√£o. Verifique a configura√ß√£o do Firebase no console.");
      }
    });

    document.getElementById("reviewsSummary").addEventListener("click",()=>{
      const card=document.getElementById("reviewsCard");
      card.style.display = "block";
      window.scrollTo({top:card.offsetTop-20,behavior:"smooth"});
    });

    loadReviewsFromFirebase();

    // ===================== Produtos & Carrinho =====================
    const data={products:[
      {id:1,name:'Cookie Tradicional',desc:'Feito com massa artesanal de baunilha, recheado com chocolate.',weight:'Aprox. 70g',price:9.99,image:'asserts/cookie.png'},
      {id:2,name:'Afogadinho de Brownie ‚Äî Dois Amores',desc:'Brownie macio com brigadeiro branco e preto.',weight:'Aprox. 250g',price:14.50,image:'asserts/afogadinho de brownie dois amores editado.png'},
      {id:3,name:'Afogadinho de Brownie ‚Äî Chocolate Branco',desc:'Brownie intenso com brigadeiro branco cremoso.',weight:'Aprox. 250g',price:14.50,image:'asserts/afogadinho de brownie brigadeiro chocolate branco editado.png'},
      {id:4,name:'Mousse de Maracuj√° com Nutella',desc:'Mousse leve de maracuj√° com camadas de Nutella.',weight:'Aprox. 250g',price:14.70,image:'asserts/mousse de maracuja com nujtella editado.png'},
      {id:5,name:'Bolo no Pote ‚Äî Brigadeiro',desc:'Massa de chocolate recheada com brigadeiro.',weight:'Aprox. 250g',price:14.99,image:'asserts/bolo no pote chocolate.png'},
      {id:6,name:'Bolo no Pote ‚Äî Prest√≠gio',desc:'Bolo de chocolate com recheio cremoso de coco.',weight:'Aprox. 250g',price:14.99,image:'asserts/Sobremesa de Chocolate e Creme.png'},
      {id:7,name:'Bolo no Pote ‚Äî Dois Amores',desc:'Camadas de brigadeiro preto e branco.',weight:'Aprox. 250g',price:14.99,image:'asserts/dois amores editado.png'},
      {id:8,name:'Bolo no Pote ‚Äî Maracuj√° Trufado',desc:'Massa leve com creme de maracuj√°.',weight:'Aprox. 250g',price:14.99,image:'asserts/bolo no pote maracuj√°2.png'},
      {id:9,name:'Bolo no Pote ‚Äî Cenoura com Brigadeiro',desc:'Bolo de cenoura com brigadeiro.',weight:'Aprox. 250g',price:14.99,image:'asserts/bolo no pote cenoura com chocolate.png'},
      {id:10,name:'Mini Empad√£o de Frango com Requeij√£o',desc:'Massa podre com frango desfiado e requeij√£o.',weight:'Aprox. 350g',price:15.20,image:'asserts/mini empad√£o.png'}
    ]};

    const WA_NUMBER='5583986153575';
    let cart=[];

    const productListEl=document.getElementById('productList');
    const cartCountEl=document.getElementById('cartCount');
    const cartItemsEl=document.getElementById('cartItems');
    const cartTotalEl=document.getElementById('cartTotal');

    function formatPrice(v){ return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'}); }

    function renderProducts(){
      productListEl.innerHTML = '';
      data.products.forEach(p => {
        const el = document.createElement('div');
        el.className = 'product';
        el.innerHTML = `
          <img src="${p.image}" alt="${p.name}" loading="lazy"/>
          <div class="product-info">
            <h3>${p.name}</h3>
            <p>${p.desc}</p>
            <div class="product-meta">
              <div class="price">${formatPrice(p.price)}</div>
              <div class="weight">${p.weight}</div>
            </div>
          </div>
          <div class="controls">
            <span class="product-qty" style="font-weight:700;color:var(--brown);margin-bottom:6px">0</span>
            <button class="add-btn" data-id="${p.id}">Adicionar</button>
          </div>
        `;
        el.querySelector('.add-btn').addEventListener('click', () => addToCart(p.id));
        productListEl.appendChild(el);
      });
    }

    function renderCart(){
      cartCountEl.textContent = cart.reduce((a,b)=>a+b.qty,0);
      cartItemsEl.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        total += item.price * item.qty;
        const el = document.createElement('div');
        el.className = 'cart-item';
        el.innerHTML = `
          <img src="${item.image}" alt="${item.name}"/>
          <div style="flex:1">
            <div style="font-weight:600;font-size:14px">${item.name}</div>
            <div class="qty">
              <button>-</button>
              <span>${item.qty}</span>
              <button>+</button>
            </div>
          </div>
          <div style="font-size:14px">${formatPrice(item.price*item.qty)}</div>
        `;
        const btns = el.querySelectorAll('button');
        btns[0].addEventListener('click', () => decreaseQty(item.id));
        btns[1].addEventListener('click', () => increaseQty(item.id));
        cartItemsEl.appendChild(el);
      });
      cartTotalEl.textContent = 'Total: ' + formatPrice(total);

      document.querySelectorAll('.product').forEach(prodEl => {
        const btn = prodEl.querySelector('.add-btn');
        if (!btn) return;
        const id = Number(btn.dataset.id);
        const cartItem = cart.find(c => c.id === id);
        const qtySpan = prodEl.querySelector('.product-qty');
        if (qtySpan) qtySpan.textContent = cartItem ? cartItem.qty : 0;
      });
    }

    function addToCart(id){
      const item = cart.find(i => i.id === id);
      if (item) item.qty++;
      else {
        const prod = data.products.find(p => p.id === id);
        cart.push({...prod, qty: 1});
      }
      renderCart();
    }

    function decreaseQty(id){
      const item = cart.find(i => i.id === id);
      if (!item) return;
      item.qty--;
      if (item.qty <= 0) cart = cart.filter(i => i.id !== id);
      renderCart();
    }

    function increaseQty(id){ addToCart(id); }

    window.addToCart = addToCart;
    window.decreaseQty = decreaseQty;
    window.increaseQty = increaseQty;

    renderProducts();
    renderCart();

    document.getElementById('checkoutBtn').addEventListener('click', () => {
      if (cart.length === 0) { alert('Adicione algum produto antes de finalizar!'); return; }
      const form = document.getElementById('customerForm');
      if (!form.checkValidity()) { form.reportValidity(); return; }
      const name = form.firstName.value + ' ' + form.lastName.value;
      const address = form.address.value;
      const contact = form.contact.value;
      const notes = form.notes.value;
      let msg = `*Pedido Doce V√≠cio*\nNome: ${name}\nEndere√ßo: ${address}\nContato: ${contact}\nObserva√ß√µes: ${notes}\n\nProdutos:\n`;
      cart.forEach(item => { msg += `- ${item.name} (${item.qty}x) = ${formatPrice(item.price * item.qty)}\n`; });
      msg += `\n*Total:* ${formatPrice(cart.reduce((a,b)=>a+b.price*b.qty,0))}\nPedido: DV-${Math.floor(Math.random()*90000+10000)}`;
      window.open(`https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank');
    });

  </script>

</body>
</html>






